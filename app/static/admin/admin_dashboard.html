<!doctype html>
<html lang="en" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta http-equiv="X-Frame-Options" content="DENY" />
    <meta http-equiv="X-Content-Type-Options" content="nosniff" />
    <meta http-equiv="Referrer-Policy" content="no-referrer" />
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; img-src 'self' data:; style-src 'self' 'unsafe-inline'; script-src 'self' 'unsafe-inline'; connect-src 'self' https://aiproductivity-backend-rhwrraai2a-uc.a.run.app;" />
    <title>Admin Dashboard</title>
    <link rel="stylesheet" href="./admin_styles.css" />
  </head>
  <body>
    <svg xmlns="http://www.w3.org/2000/svg" style="display:none">
      <!-- A few inline fallback icons if sprite not loaded -->
      <symbol id="icon-home" viewBox="0 0 24 24"><path fill="currentColor" d="M12 3 2 12h3v8h6v-6h2v6h6v-8h3z"/></symbol>
      <symbol id="icon-settings" viewBox="0 0 24 24"><path fill="currentColor" d="M19.14 12.94a7.43 7.43 0 0 0 .05-1 7.43 7.43 0 0 0-.05-1l2.11-1.65a.5.5 0 0 0 .11-.65l-2-3.46a.5.5 0 0 0-.6-.22l-2.49 1a7.44 7.44 0 0 0-1.73-1l-.38-2.65a.5.5 0 0 0-.5-.42h-4a.5.5 0 0 0-.5.42l-.38 2.65a7.44 7.44 0 0 0-1.73 1l-2.49-1a.5.5 0 0 0-.6.22l-2 3.46a.5.5 0 0 0 .11.65l2.11 1.65a7.43 7.43 0 0 0-.05 1 7.43 7.43 0 0 0 .05 1L2.86 14.6a.5.5 0 0 0-.11.65l2 3.46a.5.5 0 0 0 .6.22l2.49-1a7.44 7.44 0 0 0 1.73 1l.38 2.65a.5.5 0 0 0 .5.42h4a.5.5 0 0 0 .5-.42l.38-2.65a7.44 7.44 0 0 0 1.73-1l2.49 1a.5.5 0 0 0 .6-.22l2-3.46a.5.5 0 0 0-.11-.65ZM12 15.5A3.5 3.5 0 1 1 15.5 12 3.5 3.5 0 0 1 12 15.5Z"/></symbol>
      <symbol id="icon-key" viewBox="0 0 24 24"><path fill="currentColor" d="M14 3a7 7 0 1 0 4.9 12l2.6 2.6L23 16l-2.6-2.6A7 7 0 0 0 14 3Zm-4 7a3 3 0 1 1 3 3 3 3 0 0 1-3-3Z"/></symbol>
    </svg>

    <div class="layout">
      <aside class="sidebar" aria-label="Sidebar navigation">
        <div class="sidebar-inner">
          <div class="brand">
            <svg width="20" height="20"><use href="#icon-home"/></svg>
            <span>Admin Console</span>
          </div>
          <nav class="nav" role="navigation">
            <a class="active" href="#" data-view="dashboard"><svg width="18" height="18"><use href="#icon-home"/></svg> Dashboard</a>
            <a href="#" data-view="feedback">ğŸ“ User Feedback</a>
            <a href="#" data-view="api-config"><svg width="18" height="18"><use href="#icon-key"/></svg> API Configuration</a>
            <a href="#" data-view="system-settings"><svg width="18" height="18"><use href="#icon-settings"/></svg> System Settings</a>
            <a href="#" data-view="api-testing">ğŸ§ª API Testing</a>
            <a href="#" data-view="audit-logs">ğŸ“„ Audit Logs</a>
            <a href="#" data-view="system-health">â¤ï¸ System Health</a>
          </nav>
          
          <div style="padding:16px;border-top:1px solid var(--border);margin-top:auto">
            <div style="font-size:12px;font-weight:600;color:var(--text-secondary);margin-bottom:12px;text-transform:uppercase">Quick Links</div>
            <div style="display:flex;flex-direction:column;gap:8px">
              <a href="https://console.firebase.google.com/project/productivityai-mvp/usage" target="_blank" rel="noopener noreferrer" style="display:flex;align-items:center;gap:8px;padding:8px;border-radius:6px;text-decoration:none;color:var(--text);font-size:13px;transition:background 0.2s" onmouseover="this.style.background='var(--hover)'" onmouseout="this.style.background='transparent'">
                ğŸ’³ <span>Usage & Billing</span>
              </a>
              <a href="https://console.firebase.google.com/project/productivityai-mvp/firestore" target="_blank" rel="noopener noreferrer" style="display:flex;align-items:center;gap:8px;padding:8px;border-radius:6px;text-decoration:none;color:var(--text);font-size:13px;transition:background 0.2s" onmouseover="this.style.background='var(--hover)'" onmouseout="this.style.background='transparent'">
                ğŸ—„ï¸ <span>Firestore Console</span>
              </a>
              <a href="https://console.cloud.google.com/run?project=productivityai-mvp" target="_blank" rel="noopener noreferrer" style="display:flex;align-items:center;gap:8px;padding:8px;border-radius:6px;text-decoration:none;color:var(--text);font-size:13px;transition:background 0.2s" onmouseover="this.style.background='var(--hover)'" onmouseout="this.style.background='transparent'">
                â˜ï¸ <span>Cloud Run</span>
              </a>
              <a href="https://console.firebase.google.com/project/productivityai-mvp/authentication/users" target="_blank" rel="noopener noreferrer" style="display:flex;align-items:center;gap:8px;padding:8px;border-radius:6px;text-decoration:none;color:var(--text);font-size:13px;transition:background 0.2s" onmouseover="this.style.background='var(--hover)'" onmouseout="this.style.background='transparent'">
                ğŸ‘¥ <span>Users</span>
              </a>
              <a href="https://github.com/YuvinC/agentic-productivity" target="_blank" rel="noopener noreferrer" style="display:flex;align-items:center;gap:8px;padding:8px;border-radius:6px;text-decoration:none;color:var(--text);font-size:13px;transition:background 0.2s" onmouseover="this.style.background='var(--hover)'" onmouseout="this.style.background='transparent'">
                ğŸ’» <span>GitHub Repo</span>
              </a>
              <a href="https://productivityai-mvp.web.app" target="_blank" rel="noopener noreferrer" style="display:flex;align-items:center;gap:8px;padding:8px;border-radius:6px;text-decoration:none;color:var(--text);font-size:13px;transition:background 0.2s" onmouseover="this.style.background='var(--hover)'" onmouseout="this.style.background='transparent'">
                ğŸŒ <span>Live App</span>
              </a>
              <a href="https://console.cloud.google.com/logs/query?project=productivityai-mvp" target="_blank" rel="noopener noreferrer" style="display:flex;align-items:center;gap:8px;padding:8px;border-radius:6px;text-decoration:none;color:var(--text);font-size:13px;transition:background 0.2s" onmouseover="this.style.background='var(--hover)'" onmouseout="this.style.background='transparent'">
                ğŸ“Š <span>Cloud Logs</span>
              </a>
            </div>
          </div>
          
          <div class="sidebar-footer">
            <button id="themeToggle" class="btn-primary" style="height:40px">Toggle Theme</button>
            <button id="logoutBtn" class="btn-primary" style="height:40px">Logout</button>
          </div>
        </div>
      </aside>

      <section>
        <header class="topbar" id="topbar">
          <div class="breadcrumbs">Home / API Configuration</div>
          <div class="search" role="search">
            <svg width="16" height="16" aria-hidden="true"><circle cx="7" cy="7" r="6" stroke="currentColor" fill="none"/><path d="M11 11l4 4" stroke="currentColor"/></svg>
            <input id="search" placeholder="Searchâ€¦" aria-label="Search" />
          </div>
          <div style="display:flex;align-items:center;gap:8px;">
            <button id="notifications" aria-label="Notifications">ğŸ””</button>
            <div aria-label="Admin user" role="img">ğŸ‘¤</div>
          </div>
        </header>

        <main class="content" id="content" tabindex="-1">
          <section aria-labelledby="api-config-header">
            <header class="card-header" id="api-config-header">
              <div>
                <h2 style="margin:0">API Configuration</h2>
                <p class="login-subtitle" style="margin:4px 0 0">Manage your AI and cloud service integrations</p>
              </div>
              <div style="display:flex;gap:8px;">
                <button class="btn-primary" id="saveConfig" style="width:auto;padding:0 14px;height:40px">Save Changes</button>
                <button class="btn-primary" id="testAll" style="width:auto;padding:0 14px;height:40px;background:var(--gradient-success)">Test All</button>
              </div>
            </header>

            <div class="cards">
              <article class="card" aria-labelledby="ai-services">
                <div class="card-header"><h3 id="ai-services" style="margin:0">AI Services</h3><span class="status-badge"><span class="status-dot" style="background:var(--success)"></span> Connected</span></div>
                <div class="form-row"><input class="input" id="openaiKey" placeholder=" " type="password" /><label class="floating-label" for="openaiKey">OpenAI API Key</label></div>
                <div class="form-row"><input class="input" id="geminiKey" placeholder=" " type="password" /><label class="floating-label" for="geminiKey">Gemini API Key</label></div>
                <div class="form-row"><textarea class="input" id="llmTemplate" placeholder=" " style="height:140px"></textarea><label class="floating-label" for="llmTemplate">LLM Prompt Template (used by /chat)</label></div>
                <div style="display:flex;gap:8px;">
                  <button class="btn-primary" id="testOpenAI" style="width:auto;padding:0 14px;height:40px">Test OpenAI</button>
                  <button class="btn-primary" id="testGemini" style="width:auto;padding:0 14px;height:40px">Test Gemini</button>
                </div>
              </article>

              <article class="card" aria-labelledby="gcloud">
                <div class="card-header"><h3 id="gcloud" style="margin:0">Google Cloud</h3></div>
                <div class="form-row"><input class="input" id="gProject" placeholder=" " /><label class="floating-label" for="gProject">Project ID</label></div>
                <div class="form-row"><textarea class="input" id="gCreds" placeholder=" " style="height:120px"></textarea><label class="floating-label" for="gCreds">Credentials JSON</label></div>
                <button class="btn-primary" id="testGoogle" style="width:auto;padding:0 14px;height:40px">Validate Credentials</button>
              </article>

              <article class="card" aria-labelledby="firebase">
                <div class="card-header"><h3 id="firebase" style="margin:0">Firebase</h3></div>
                <div class="form-row"><textarea class="input" id="fbConfig" placeholder=" " style="height:120px"></textarea><label class="floating-label" for="fbConfig">Config JSON</label></div>
                <button class="btn-primary" id="testFirebase" style="width:auto;padding:0 14px;height:40px">Initialize</button>
              </article>

              <article class="card" aria-labelledby="smtp">
                <div class="card-header"><h3 id="smtp" style="margin:0">Email / SMTP</h3></div>
                <div class="form-row"><input class="input" id="smtpHost" placeholder=" " /><label class="floating-label" for="smtpHost">Host</label></div>
                <div class="form-row"><input class="input" id="smtpPort" placeholder=" " type="number" /><label class="floating-label" for="smtpPort">Port</label></div>
                <div class="form-row"><input class="input" id="smtpUser" placeholder=" " /><label class="floating-label" for="smtpUser">Username</label></div>
                <div class="form-row"><input class="input" id="smtpPass" placeholder=" " type="password" /><label class="floating-label" for="smtpPass">Password</label></div>
                <button class="btn-primary" id="testSmtp" style="width:auto;padding:0 14px;height:40px">Send Test Email</button>
              </article>

              <article class="card" aria-labelledby="app-settings">
                <div class="card-header"><h3 id="app-settings" style="margin:0">Application Settings</h3></div>
                <div class="form-row"><input class="input" id="defaultCalGoal" placeholder=" " type="number" /><label class="floating-label" for="defaultCalGoal">Default calorie goal</label></div>
                <div class="form-row"><input class="input" id="reminderTimes" placeholder=" " /><label class="floating-label" for="reminderTimes">Reminder times (comma-separated)</label></div>
              </article>
            </div>
          </section>

          <section aria-labelledby="audit-logs" class="card">
            <h3 id="audit-logs">Audit Logs</h3>
            <div class="table-wrap">
              <table aria-label="Audit logs table">
                <thead><tr><th>Timestamp</th><th>User</th><th>Action</th><th>Resource</th><th>Status</th><th>IP</th></tr></thead>
                <tbody id="auditTable"></tbody>
              </table>
            </div>
          </section>

        </main>
      </section>
    </div>

    <div class="toasts" id="toasts" aria-live="polite" aria-atomic="true"></div>
    <div id="modalRoot" class="modal-backdrop" role="dialog" aria-modal="true"></div>

    <script src="./admin_scripts.js" defer></script>
  </body>
  </html>


